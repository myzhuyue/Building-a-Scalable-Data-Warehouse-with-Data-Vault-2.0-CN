## 4.2 Data Vault 建模常用语

数据仓库模型代表了4.1节中描述的自然模型向数据仓库的以业务为中心的模型的转变。该模型表示业务流程，并通过业务键与业务联系在一起。这是数据仓库模型的一个重要属性，因为业务主键表明企业如何在其系统中整合、连接和访问信息。由于Data Vault模型以业务主键为导向，我们继承了以与企业在日常运营中相同的方式整合、连接和访问信息的能力。

Data Vault模型的目标是尽可能紧密地代表业务。考虑到这个目标，想想企业的关键特征。

- 对快速变化的业务需求做出反应的能力，也被称为敏捷性。
- 整合各种信息源以创造新的知识。
- 商业环境的复杂性，有时还有组织本身的复杂性。
- 抓住新的市场机会的灵活性。
- 对透明度和问责制的需求，至少对公司的审计师而言。
- 用专门的和定制的报告来回应信息要求的能力。
- 一旦业务成功，就有能力扩大规模。

这些关键特征使一个公司能够在当今竞争激烈的市场中持续发展。数据仓库模型的设计方式是，当用户建立一个数据仓库系统时，它支持所有这些关键特征。当你使用数据仓库模型时，你将能够尽可能地根据业务调整数据仓库，并利用数据仓库为你带来好处。

为了实现数据仓库模型的目标，该模型以三种基本的实体类型为基础，它们来自于上一节描述的自然模型。这些实体类型是枢纽、链接和卫星。每个实体类型都有特定的用途：枢纽将业务键与模型的其他部分分开；链接存储业务键（和/或枢纽）之间的关系；卫星存储上下文（业务键的属性或关系）。

我们在下面的章节中更详细地描述了这些实体类型。

---
### 4.2.1 枢纽实体

当业务用户在一个操作系统中访问信息时，他们使用一个业务键来指代业务对象。这可能是一个客户号码、发票号码或车辆识别号码。有时，系统要求用户提供一个键的组合，例如，一个客户号码和一个地区代码，如国家代码。在其他情况下，没有为业务对象定义业务键，但用户能够通过名称或使用其他识别属性来搜索正确的对象。由于这些业务键在识别业务对象方面的核心重要性，Data Vault模型将它们与模型的其他部分分开。中心实体的目的是将业务对象的业务键与其他一些信息一起存储，这些信息被称为元数据。

在Data Vault模型中，每种类型的业务键都有枢纽。在一个航空场景中，有单独的枢纽来存储机场代码、承运人代码和航班号，以及其他枢纽。因为它们包含了业务的键，枢纽是数据仓库模型的基础。我们在第4.3节中对枢纽进行了更详细的描述。

将Data Vault枢纽与第4.1节中的航空运输例子相比较，很明显，机场是枢纽。它们是网络中的核心元素。在Data Vault中，业务键是中心，因此位于枢纽中。

---
### 4.2.2 链接实体

就像图4.2中机场通过航班连接的方式一样，业务对象在业务中也是连接的。没有一个业务对象是完全独立于其他业务对象的。相反，它们是通过在执行任务时使用业务对象的业务过程而相互连接的。数据仓库用连接两个或多个中心的链接来模拟这些关系。典型的业务流程是采购、制造、广告、营销和销售。因为这些流程经常（但不总是）代表交易，一个链接也经常代表一个交易。因此，它常常为创建维度模型的事实提供基础（更多细节请参考第7章和第14章）。然而，这只是一个经验法则，你将在本节末尾学到。

在上一节的航空场景中（如图4.3所示），承运人、机场和航班号枢纽之间有一个链接来代表一个航班。此外，这个链接可以包括对尾号的参考。其他链接可以跟踪可用的安全事件、机上销售或座位预订。其他可能的链接可能不代表交易（因此本节介绍中的经验法则无效）。例如，可能有一个链接表示两个机场之间有一个连接（图4.4）。

该逻辑图显示了机场和承运人枢纽之间的链接。请注意对枢纽机场的两次引用，这反映了连接的起点和终点。在没有任何进一步信息的情况下，我们只知道在过去的任何时候，在给定的机场之间存在着哪种连接。我们将在下一节看到为什么这种非交易性的联系是有用的。

---
### 4.2.3 卫星实体
仅有枢纽和链接的Data Vault模型不会为我们提供足够的信息。正如我们在第4.2.2节中看到的，它们只提供业务对象之间的关系信息。缺少的部分是这些业务对象的背景和这些链接的背景。对于一个航班交易，这可能是飞机的飞行时间或航班的安全延迟。

卫星将这一功能添加到Data Vault模型中。它们存储属于业务键（在中心）、关系或交易（在链接中）的属性（图4.5）。

我们在枢纽和链接中添加了卫星，以存储需要了解存储在Data Vault中的数据背景的信息。请注意两个机场之间的连接环节上的卫星。卫星跟踪机场之间的距离和连接数。卫星还存储了属性数据的历史。每个属性的变化都会被记录到卫星上。

正如你可以看到的机场枢纽，在一个枢纽或链接上可以有多个卫星。分布枢纽或卫星的属性的原因包括多个或变化的源系统，不同的变化频率，或属性数据的功能分离。我们在4.5节和全书中对卫星进行了更详细的描述。